
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Multi-dimensional knowledge extraction system using Apache AGE">
      
      
        <meta name="author" content="Knowledge Graph System Contributors">
      
      
      
        <link rel="prev" href="../ADR-068-implementation-plan/">
      
      
        <link rel="next" href="../ADR-070-polarity-axis-analysis/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>ADR-068: Source Text Embeddings for Grounding Truth Retrieval - Knowledge Graph System</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adr-068-source-text-embeddings-for-grounding-truth-retrieval" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Knowledge Graph System" class="md-header__button md-logo" aria-label="Knowledge Graph System" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Knowledge Graph System
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ADR-068: Source Text Embeddings for Grounding Truth Retrieval
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aaronsb/knowledge-graph-system" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    aaronsb/knowledge-graph-system
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Knowledge Graph System" class="md-nav__button md-logo" aria-label="Knowledge Graph System" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Knowledge Graph System
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aaronsb/knowledge-graph-system" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    aaronsb/knowledge-graph-system
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation Index
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/COLD-START.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5-Minute Cold Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/DEPLOYMENT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployment Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/VOCABULARY_CATEGORIES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vocabulary Categories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Manual
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Manual
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Knowledge Graph System Manual
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Introduction
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/00-introduction/01-WHAT_AND_WHY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    What is the Knowledge Graph System?
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/01-getting-started/02-CLI_USAGE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg CLI Usage Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/01-getting-started/03-INGESTION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Document Ingestion Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Configuration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/02-configuration/01-AI_PROVIDERS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Provider Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/02-configuration/02-EXTRACTION_CONFIGURATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Extraction Configuration Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/02-configuration/03-EMBEDDING_CONFIGURATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Embedding Configuration Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/02-configuration/04-SWITCHING_EXTRACTION_PROVIDERS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Switching Extraction Providers - Quick Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/02-configuration/05-LOCAL_INFERENCE_IMPLEMENTATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local LLM Inference Implementation Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/02-configuration/06-EXTRACTION_QUALITY_COMPARISON/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Extraction Quality Comparison
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Integration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/03-integration/01-MCP_SETUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP Server Setup Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/03-integration/02-VOCABULARY_CONSOLIDATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Edge Vocabulary Consolidation Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Security & Access
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security & Access
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/04-security-and-access/01-AUTHENTICATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/04-security-and-access/02-RBAC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RBAC Operations Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/04-security-and-access/03-SECURITY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/04-security-and-access/04-PASSWORD_RECOVERY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Password Recovery and Account Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Maintenance
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Maintenance
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/05-maintenance/01-BACKUP_RESTORE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup and Restore Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/05-maintenance/02-DATABASE_MIGRATIONS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Migrations Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/01-SCHEMA_REFERENCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Schema Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/02-USE_CASES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use Cases: Practical Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/03-EXAMPLES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples: Real Queries, Real Results
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/04-github_project_history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub Project History Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/05-CONCEPTS_AND_TERMINOLOGY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concepts and Terminology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/06-CONCEPT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concept: Why Knowledge Graphs, Not Just RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/07-ENRICHMENT_JOURNEY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Enrichment Journey: From Empty Graph to Multi-Perspective Understanding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/08-DISTRIBUTED_SHARDING_RESEARCH/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Graph Database Sharding: Research and Architectural Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/09-CYPHER_PATTERNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Cypher Query Patterns for Apache AGE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/10-OPENCYPHER_QUERIES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    openCypher Query Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../manual/06-reference/11-LLM_EDGE_DISCOVERY_FLOW/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LLM Edge Discovery Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tool Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tool Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tool &amp; API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CLI Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    CLI Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Command Reference (Auto-Generated)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2_2" id="__nav_4_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/admin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg admin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/health/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg health
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/ingest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg ingest
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/job/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg job
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/login/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg login
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/logout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg logout
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/oauth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg oauth
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/ontology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg ontology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/commands/vocabulary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kg vocabulary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_3" >
        
          
          <label class="md-nav__link" for="__nav_4_2_3" id="__nav_4_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    media
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    media
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/cli/media/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Media Assets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    MCP Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    MCP Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP Server Tool Reference (Auto-Generated)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_2" >
        
          
          <label class="md-nav__link" for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    media
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    media
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/media/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Media Assets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3_3" id="__nav_4_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/tools/concept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    concept
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/tools/ingest-directory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ingest-directory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/tools/ingest-file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ingest-file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/tools/ingest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ingest
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/tools/inspect-file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    inspect-file
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/tools/job/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    job
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/tools/ontology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ontology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/tools/search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/mcp/tools/source/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    REST API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    REST API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REST API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ARCHITECTURE_DECISIONS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture Decision Records (ADRs)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ARCHITECTURE_OVERVIEW/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Knowledge Graph System Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../QUERY_SAFETY_BASELINE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Query Safety Baseline - Technical Debt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../RECURSIVE_UPSERT_ARCHITECTURE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recursive Upsert Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    access-workflow
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    access-workflow
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../access-workflow/ADR-001-multi-tier-agent-access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-001: Multi-Tier Agent Access Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../access-workflow/ADR-002-node-fitness-scoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-002: Node Fitness Scoring System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../access-workflow/ADR-003-semantic-tool-hints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-003: Semantic Tool Hint Networks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../access-workflow/ADR-004-pure-graph-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-004: Pure Graph Design (Library Metaphor)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../access-workflow/ADR-005-source-text-tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-005: Source Text Tracking and Retrieval
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../access-workflow/ADR-006-staging-migration-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-006: Staging and Migration Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../access-workflow/ADR-038-official-project-apparel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-038: Official Project Apparel Design Specifications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ai-embeddings
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    ai-embeddings
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-039-local-embedding-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-039: Local Embedding Service with Hybrid Client/Server Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-041-ai-extraction-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-041: AI Extraction Provider Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-042-local-extraction-inference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-042: Local LLM Inference for Concept Extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-043-single-node-resource-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-043: Single-Node Resource Management for Local Inference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-044-probabilistic-truth-convergence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-044: Probabilistic Truth Convergence Through Contradiction Resolution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-045-046-MIGRATION-PLAN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Migration Plan: ADR-045/046 Implementation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-045-unified-embedding-generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-045: Unified Embedding Generation System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-049-rate-limiting-and-concurrency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-049: Rate Limiting and Per-Provider Concurrency Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-058-polarity-axis-triangulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-058: Polarity Axis Triangulation for Grounding Calculation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-068-implementation-plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-068 Source Text Embeddings - Implementation Plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    ADR-068: Source Text Embeddings for Grounding Truth Retrieval
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-068: Source Text Embeddings for Grounding Truth Retrieval
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#current-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Current State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-problem" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Problem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-vision-large-concept-model-lcm" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Vision: Large Concept Model (LCM)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#philosophical-foundation-evidence-vs-grounding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Philosophical Foundation: Evidence vs. Grounding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Philosophical Foundation: Evidence vs. Grounding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evidence-layer-descriptive-this-adr" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evidence Layer (Descriptive - This ADR)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grounding-layer-evaluative-adr-044-adr-058" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grounding Layer (Evaluative - ADR-044, ADR-058)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-this-separation-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why This Separation Matters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decision" class="md-nav__link">
    <span class="md-ellipsis">
      
        Decision
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Decision">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-separate-embeddings-table-with-referential-integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Separate Embeddings Table with Referential Integrity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-chunking-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Chunking Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-migration-strategy-add-field-compute-on-demand" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Migration Strategy: Add Field, Compute On-Demand
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-hash-verification-for-referential-integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Hash Verification for Referential Integrity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-async-job-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Async Job Processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-generation-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Generation Triggers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-query-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Query Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-cost-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Cost and Performance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        Consequences
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Consequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#positive" class="md-nav__link">
    <span class="md-ellipsis">
      
        Positive
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#negative" class="md-nav__link">
    <span class="md-ellipsis">
      
        Negative
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neutral" class="md-nav__link">
    <span class="md-ellipsis">
      
        Neutral
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Plan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-foundation-week-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 1: Foundation (Week 1)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-generation-week-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 2: Generation (Week 2)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-query-integration-week-3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 3: Query Integration (Week 3)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-unified-embedding-regeneration-week-4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 4: Unified Embedding Regeneration (Week 4)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase 4: Unified Embedding Regeneration (Week 4)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-source-embedding-regeneration" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1: Source Embedding Regeneration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-vocabulary-embedding-regeneration" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2: Vocabulary Embedding Regeneration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-unified-api-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3: Unified API Endpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-cli-enhancement" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4: CLI Enhancement
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-cross-entity-query-foundation" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.5: Cross-Entity Query Foundation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-user-interface-integration-complete" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 5: User Interface Integration ( COMPLETE)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase 5: User Interface Integration ( COMPLETE)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-cli-source-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1: CLI Source Search 
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-mcp-server-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2: MCP Server Integration 
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-web-ui-block-builder" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3: Web UI Block Builder 
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-6-advanced-features-future" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 6: Advanced Features (Future)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-entity-query-capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cross-Entity Query Capabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Entity Query Capabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-dynamic-query-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Dynamic Query Routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-semantic-path-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Semantic Path Discovery
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-multi-entity-blending" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Multi-Entity Blending
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-contextual-re-ranking" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Contextual Re-Ranking
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-semantic-subgraph-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Semantic Subgraph Extraction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-emergent-relationship-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Emergent Relationship Discovery
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-cross-modal-query-fusion-future" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Cross-Modal Query Fusion (Future)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-this-matters-the-lcm-vision" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why This Matters: The LCM Vision
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternatives-considered" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternatives Considered
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternatives Considered">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alternative-1-generate-embeddings-at-query-time" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 1: Generate Embeddings at Query Time
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-2-store-single-embedding-on-source-node" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 2: Store Single Embedding on Source Node
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-3-only-embed-concept-descriptions-status-quo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 3: Only Embed Concept Descriptions (Status Quo)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-4-use-full-text-search-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 4: Use Full-Text Search Only
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-design-decisions-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Design Decisions Summary
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Design Decisions Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-content_hash-field-add-dont-backfill" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. content_hash Field: Add, Don't Backfill
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-no-separate-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. No Separate Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-chunk-size-500-characters-100-words" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Chunk Size: 500 Characters (~100 words)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-always-enabled" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Always Enabled
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-leverage-existing-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Leverage Existing Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-adrs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related ADRs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#large-concept-model-lcm-vision" class="md-nav__link">
    <span class="md-ellipsis">
      
        Large Concept Model (LCM) Vision
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        External Resources
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-example-queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Appendix: Example Queries
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix: Example Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-similarity-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Source Similarity Search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-concept-source-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hybrid Concept + Source Search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#context-window-for-concept" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Window for Concept
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-document-source-similarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cross-Document Source Similarity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADR-070-polarity-axis-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-070: Polarity Axis Analysis for Bidirectional Semantic Dimensions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6_13" >
        
          
          <label class="md-nav__link" for="__nav_6_6_13" id="__nav_6_6_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    media-ADR-058
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_6_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    media-ADR-058
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../media-ADR-058/README_VISUALIZATIONS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Polarity Axis Triangulation Visualizations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_7" >
        
          
          <label class="md-nav__link" for="__nav_6_7" id="__nav_6_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    authentication-security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    authentication-security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-security/ADR-017-sensitive-auth-verification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture Decision Record: Client-Initiated Token Revocation for Elevated Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-security/ADR-027-user-management-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-027: User Management API with Lightweight JWT Authentication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-security/ADR-028-dynamic-rbac-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-028: Dynamic Role-Based Access Control (RBAC) System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-security/ADR-031-encrypted-api-key-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-031: Encrypted API Key Storage with Container Secrets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-security/ADR-054-oauth-client-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-054: OAuth 2.0 Client Management for Multi-Client Authentication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-security/ADR-060-endpoint-security-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-060: API Endpoint Security Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-security/ADR-062-mcp-file-ingestion-security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-062: MCP File Ingestion Security Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_8" >
        
          
          <label class="md-nav__link" for="__nav_6_8" id="__nav_6_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    database-schema
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    database-schema
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database-schema/ADR-016-apache-age-migration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-016: Apache AGE Migration (Neo4j Replacement)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database-schema/ADR-024-multi-schema-postgresql-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-024: Multi-Schema PostgreSQL Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database-schema/ADR-040-database-schema-migrations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-040: Database Schema Migration Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database-schema/ADR-061-operator-pattern-lifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-061: Operator Pattern for Platform Lifecycle Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_9" >
        
          
          <label class="md-nav__link" for="__nav_6_9" id="__nav_6_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    infrastructure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    infrastructure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/ADR-012-api-server-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-012: API Server Architecture for Scalable Neo4j Access
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/ADR-015-backup-restore-streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-015: Backup/Restore Streaming Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/ADR-018-server-sent-events-streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-018: Server-Sent Events for Real-Time Progress Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/ADR-020-admin-module-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-020: Admin Module Architecture Pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/ADR-021-live-man-switch-ai-safety/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-021: Live Man Switch - AI Safety for Critical Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/ADR-050-scheduled-jobs-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-050: Scheduled Jobs System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/ADR-055-cdn-serverless-deployment-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-055: CDN and Serverless Deployment Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infrastructure/ADR-056-timezone-aware-datetime-utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-056: Timezone-Aware Datetime Utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_10" >
        
          
          <label class="md-nav__link" for="__nav_6_10" id="__nav_6_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ingestion-content
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    ingestion-content
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ingestion-content/ADR-014-job-approval-workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-014: Job Approval Workflow with Pre-Ingestion Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ingestion-content/ADR-023-markdown-structured-content-preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-023: Markdown Structured Content Preprocessing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ingestion-content/ADR-033-multimodal-ingestion-configurable-prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-033: Multimodal Image Ingestion with Configurable Prompt System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ingestion-content/ADR-037-human-guided-graph-editing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-037: Human-Guided Graph Editing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ingestion-content/ADR-051a-graph-document-deduplication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-051: Graph-Based Provenance Tracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ingestion-content/ADR-051b-API-CHANGES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-051: API Changes for Graph-Based Document Deduplication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ingestion-content/ADR-057a-multimodal-image-ingestion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-057: Multimodal Image Ingestion with Visual Context Injection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ingestion-content/ADR-057b-appendix-single-vs-two-stage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-057 Appendix: Single-Stage vs Two-Stage Image Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_11" >
        
          
          <label class="md-nav__link" for="__nav_6_11" id="__nav_6_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    proposals
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    proposals
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../proposals/PARALLEL_GRAPH_QUERY_DESIGN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parallel Graph Query Execution - Design Proposal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_12" >
        
          
          <label class="md-nav__link" for="__nav_6_12" id="__nav_6_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    query-search
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    query-search
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../query-search/ADR-030-concept-deduplication-validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-030: Concept Deduplication Quality Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../query-search/ADR-063-semantic-diversity-authenticity-signal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-063: Semantic Diversity as Authenticity Signal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../query-search/ADR-066-published-query-endpoints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-066: Published Query Endpoints
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_13" >
        
          
          <label class="md-nav__link" for="__nav_6_13" id="__nav_6_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    user-interfaces
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    user-interfaces
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-011-cli-admin-separation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-011: CLI and Admin Tooling Separation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-013-unified-typescript-client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-013: Unified TypeScript Client (CLI + MCP Server)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-019-type-based-table-formatting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-019: Type-Based Table Formatting System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-029-cli-theory-of-operation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-029: CLI Theory of Operation - Hybrid Unix/Domain-Specific Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-034-graph-visualization-query-workbench/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-034: Graph Visualization &amp; Interactive Query Explorers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-035-explorer-methods-uses-capabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-035: Explorer Methods, Uses, and Capabilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-036-universal-visual-query-builder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-036: Universal Visual Query Builder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-064-specialized-truth-convergence-visualizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-064: Specialized Truth Convergence Visualizations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-067-web-app-workstation-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-067: Web Application Workstation Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interfaces/ADR-069-semantic-fuse-filesystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-069: Semantic FUSE Filesystem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_14" >
        
          
          <label class="md-nav__link" for="__nav_6_14" id="__nav_6_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    vocabulary-relationships
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    vocabulary-relationships
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-022-semantic-relationship-taxonomy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-022: Semantically Sparse 30-Type Relationship Taxonomy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-025-dynamic-relationship-vocabulary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-025: Dynamic Relationship Vocabulary Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-026-autonomous-vocabulary-curation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-026: Autonomous Vocabulary Curation and Ontology Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-032a-automatic-edge-vocabulary-expansion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-032: Automatic Edge Vocabulary Expansion with Intelligent Pruning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-032b-IMPLEMENTATION-NOTES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-032 Implementation Quick Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-046-grounding-aware-vocabulary-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-046: Grounding-Aware Vocabulary Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-047-probabilistic-vocabulary-categorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-047: Probabilistic Vocabulary Categorization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-048-vocabulary-metadata-as-graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-048: Vocabulary Metadata as First-Class Graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-052-vocabulary-expansion-consolidation-cycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-052: Vocabulary Expansion-Consolidation Cycle (The "Dreaming" Pattern)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-053-eager-vocabulary-categorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-053: Eager Vocabulary Categorization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-059-llm-determined-relationship-direction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-059: LLM-Determined Relationship Direction Semantics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary-relationships/ADR-065-vocabulary-based-provenance-relationships/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADR-065: Vocabulary-Based Provenance Relationships
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/AUTO-DOCUMENTATION-STRATEGY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Auto-Documentation Strategy for CLI Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/DEV_JOURNAL_chunked_ingestion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development Journal: Chunked Ingestion System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/DEV_JOURNAL_minio_integration_and_emergent_visual_relationships/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development Journal: MinIO Integration &amp; Emergent Visual Relationships
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/LEARNED_KNOWLEDGE_MCP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learned Knowledge Synthesis - MCP Enhancement Plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/pattern-repetition-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pattern Repetition in Growth Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/relationship-semantics-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Relationship Semantics: How Others Do It vs. Our Proposal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/vocabulary-direction-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vocabulary Direction Semantics Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/API_AUTH_AUDIT_RESULTS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Endpoint Authentication Audit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/API_AUTH_AUDIT_SUMMARY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Authentication Audit Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/API_AUTH_TESTING_RESEARCH/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Authentication Testing Research
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/INTEGRATION_TEST_NOTES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integration Test Notes - Working Commands &amp; Observations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/INTEGRATION_TEST_PLAN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Knowledge Graph System - Integration Test Plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/SCHEMA_MIGRATION_TEST_REPORT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Schema Migration - Functional Test Report
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../testing/TEST_COVERAGE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Test Coverage Areas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#current-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        Current State
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-problem" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Problem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-vision-large-concept-model-lcm" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Vision: Large Concept Model (LCM)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#philosophical-foundation-evidence-vs-grounding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Philosophical Foundation: Evidence vs. Grounding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Philosophical Foundation: Evidence vs. Grounding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#evidence-layer-descriptive-this-adr" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evidence Layer (Descriptive - This ADR)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grounding-layer-evaluative-adr-044-adr-058" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grounding Layer (Evaluative - ADR-044, ADR-058)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-this-separation-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why This Separation Matters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decision" class="md-nav__link">
    <span class="md-ellipsis">
      
        Decision
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Decision">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-separate-embeddings-table-with-referential-integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Separate Embeddings Table with Referential Integrity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-chunking-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Chunking Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-migration-strategy-add-field-compute-on-demand" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Migration Strategy: Add Field, Compute On-Demand
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-hash-verification-for-referential-integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Hash Verification for Referential Integrity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-async-job-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Async Job Processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-generation-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Generation Triggers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-query-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Query Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-cost-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Cost and Performance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        Consequences
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Consequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#positive" class="md-nav__link">
    <span class="md-ellipsis">
      
        Positive
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#negative" class="md-nav__link">
    <span class="md-ellipsis">
      
        Negative
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neutral" class="md-nav__link">
    <span class="md-ellipsis">
      
        Neutral
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Plan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-foundation-week-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 1: Foundation (Week 1)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-generation-week-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 2: Generation (Week 2)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-query-integration-week-3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 3: Query Integration (Week 3)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-unified-embedding-regeneration-week-4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 4: Unified Embedding Regeneration (Week 4)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase 4: Unified Embedding Regeneration (Week 4)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-source-embedding-regeneration" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1: Source Embedding Regeneration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-vocabulary-embedding-regeneration" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2: Vocabulary Embedding Regeneration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-unified-api-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3: Unified API Endpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-cli-enhancement" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4: CLI Enhancement
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-cross-entity-query-foundation" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.5: Cross-Entity Query Foundation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-user-interface-integration-complete" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 5: User Interface Integration ( COMPLETE)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase 5: User Interface Integration ( COMPLETE)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-cli-source-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1: CLI Source Search 
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-mcp-server-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2: MCP Server Integration 
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-web-ui-block-builder" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3: Web UI Block Builder 
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-6-advanced-features-future" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 6: Advanced Features (Future)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-entity-query-capabilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cross-Entity Query Capabilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Entity Query Capabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-dynamic-query-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Dynamic Query Routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-semantic-path-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Semantic Path Discovery
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-multi-entity-blending" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Multi-Entity Blending
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-contextual-re-ranking" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Contextual Re-Ranking
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-semantic-subgraph-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Semantic Subgraph Extraction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-emergent-relationship-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Emergent Relationship Discovery
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-cross-modal-query-fusion-future" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Cross-Modal Query Fusion (Future)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-this-matters-the-lcm-vision" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why This Matters: The LCM Vision
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternatives-considered" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternatives Considered
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternatives Considered">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alternative-1-generate-embeddings-at-query-time" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 1: Generate Embeddings at Query Time
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-2-store-single-embedding-on-source-node" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 2: Store Single Embedding on Source Node
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-3-only-embed-concept-descriptions-status-quo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 3: Only Embed Concept Descriptions (Status Quo)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-4-use-full-text-search-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 4: Use Full-Text Search Only
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-design-decisions-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Design Decisions Summary
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Design Decisions Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-content_hash-field-add-dont-backfill" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. content_hash Field: Add, Don't Backfill
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-no-separate-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. No Separate Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-chunk-size-500-characters-100-words" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Chunk Size: 500 Characters (~100 words)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-always-enabled" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Always Enabled
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-leverage-existing-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Leverage Existing Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-adrs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Related ADRs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#large-concept-model-lcm-vision" class="md-nav__link">
    <span class="md-ellipsis">
      
        Large Concept Model (LCM) Vision
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        External Resources
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-example-queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Appendix: Example Queries
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix: Example Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-similarity-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Source Similarity Search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-concept-source-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hybrid Concept + Source Search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#context-window-for-concept" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Window for Concept
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-document-source-similarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cross-Document Source Similarity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="adr-068-source-text-embeddings-for-grounding-truth-retrieval">ADR-068: Source Text Embeddings for Grounding Truth Retrieval</h1>
<p><strong>Status:</strong> Accepted - Partially Implemented (Phase 1-3, 5 complete, Phase 4 pending)
<strong>Date:</strong> 2025-11-27
<strong>Updated:</strong> 2025-11-29 (Phase 5 complete: Source search interfaces - CLI, MCP, Web UI)
<strong>Deciders:</strong> System Architect
<strong>Tags:</strong> #embeddings #source-retrieval #async-processing #lcm</p>
<h2 id="overview">Overview</h2>
<p>Your knowledge graph has embeddings for concepts (the ideas extracted from documents) and embeddings for relationship types (SUPPORTS, CONTRADICTS, etc.), but here's what's missing: embeddings for the source documents themselvesthe actual paragraphs and passages that concepts came from. This creates a blind spot. You can search for concepts semantically ("find concepts similar to 'recursive depth tracking'"), but you can't search the original text that way. You're forced to use keyword search, which misses semantic matches.</p>
<p>Think about the difference between these two questions: "Which concepts are related to performance optimization?" versus "Show me the original passages that discuss performance optimization." The first searches concept labels; the second searches the source text. Without source embeddings, you can only answer the first question semantically. For the second, you're stuck with keyword matching"WHERE full_text LIKE '%performance%'"which misses passages that discuss optimization without using that exact word.</p>
<p>This matters for RAG (Retrieval-Augmented Generation) workflows. When you want to answer a question using your knowledge graph, you need to retrieve relevant contextnot just concept names, but the actual text that provides nuanced detail. Source embeddings enable this: generate an embedding for the user's question, find the most similar source passages, and feed that rich context to an LLM for generation. It's the difference between saying "there's a concept called 'caching strategies'" (shallow) versus showing the actual paragraph explaining different caching approaches (deep).</p>
<p>This ADR implements source text embeddings as a first-class system feature, stored in a separate table with chunk-level granularity and hash-based verification. Each source passage gets split into embedding chunks (around 100-120 words each, stored with character offsets for precise highlighting), and the system tracks which chunks came from which source using content hashes. This enables three new capabilities: semantic search over source passages, hybrid queries that blend concept matches with source matches, and complete RAG workflows that retrieve evidence-rich context for generation. The vision is a "Large Concept Model" where everything in the graphconcepts, sources, relationships, even imagesparticipates in semantic search and retrieval.</p>
<hr />
<h2 id="context">Context</h2>
<h3 id="current-state">Current State</h3>
<p>The system currently generates embeddings for:
- <strong>Concepts</strong>: Label + description + search terms (text embeddings)
- <strong>Relationship Types</strong>: Vocabulary embeddings for grounding calculations (ADR-044)
- <strong>Images</strong>: Visual embeddings (Nomic Vision v1.5, 768-dim, ADR-057)</p>
<p>However, <strong>Source nodes</strong> (the grounding truth documents) do NOT have embeddings:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># From api/api/workers/ingestion_worker.py:294</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">text_embedding</span><span class="o">=</span><span class="kc">None</span>  <span class="c1"># Will be generated during concept extraction</span>
</code></pre></div>
<p>Source nodes contain:
- <code>full_text</code> - Raw paragraph/chunk text (potentially 500-1500 words)
- <code>document</code> - Ontology name
- <code>paragraph</code> - Chunk number
- <code>content_type</code> - "document" or "image"
- No embedding field for text similarity search</p>
<h3 id="the-problem">The Problem</h3>
<p>This creates a critical gap in retrieval capabilities:</p>
<ol>
<li><strong>No Direct Source Search</strong>: Cannot find similar source passages via embedding similarity</li>
<li><strong>Lost Context</strong>: When a concept matches, we can't easily find related context from neighboring source text</li>
<li><strong>Incomplete RAG</strong>: The system has concept embeddings but not the underlying evidence embeddings</li>
<li><strong>Search Mode Gap</strong>:</li>
<li> Text search (full-text indexes on Source.full_text)</li>
<li> Concept search (embedding similarity on Concept.embedding)</li>
<li> Source passage search (no embedding on Source nodes)</li>
</ol>
<h3 id="the-vision-large-concept-model-lcm">The Vision: Large Concept Model (LCM)</h3>
<p>This ADR is a foundational piece toward a <strong>Large Concept Model</strong> architecture where ALL graph elements participate in semantic search:</p>
<p><strong>Current state (Concept-centric)</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Text  Concepts  Embeddings  Graph
</code></pre></div></p>
<p><strong>Target state (LCM - Everything embedded)</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Text  {Concepts, Sources, Edges}  Embeddings  Multi-modal Graph
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>                                           
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>      Recursive Relationships      Constructive Queries
</code></pre></div></p>
<p><strong>LCM Characteristics:</strong>
1. <strong>Text Search</strong>: Traditional full-text indexes
2. <strong>Text Embeddings</strong>: Dense vector search on passages
3. <strong>RAG</strong>: Retrieve and generate from source chunks
4. <strong>Visual Embeddings</strong>: Image similarity search ( ADR-057)
5. <strong>Graph Embeddings</strong>: Concept and edge embeddings ( ADR-044, ADR-045)
6. <strong>Source Embeddings</strong>: Grounding truth chunk search ( <strong>This ADR</strong>)
7. <strong>Emergent Edges</strong>: Relationships discovered via embedding proximity
8. <strong>Constructive Queries</strong>: Build knowledge paths from multi-modal signals</p>
<h3 id="philosophical-foundation-evidence-vs-grounding">Philosophical Foundation: Evidence vs. Grounding</h3>
<p><strong>IMPORTANT:</strong> Source embeddings serve a fundamentally different purpose than grounding calculation. This distinction is critical to understanding the architecture:</p>
<h4 id="evidence-layer-descriptive-this-adr">Evidence Layer (Descriptive - This ADR)</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Source Text  Extraction  Concept
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>&quot;The recursive depth tracker maintains state...&quot;
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>                
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>        [Concept: &quot;Recursive Depth Tracking&quot;]
</code></pre></div>
<p><strong>Purpose:</strong> Provenance and evidence retrieval
- <strong>Nature:</strong> Observational, neutral representation
- <strong>Language:</strong> "Concept" (intentionally NOT "fact" or "truth")
- <strong>What it captures:</strong> Ideas stated/observed in source text
- <strong>Judgment:</strong> None - purely descriptive
- <strong>Query use case:</strong> "Show me the original text where this concept came from"</p>
<p><strong>Graph Traversal:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">(:</span><span class="n">Concept</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">EVIDENCED_BY</span><span class="o">]-&gt;</span><span class="p">(:</span><span class="n">Instance</span><span class="p">)</span><span class="o">-[</span><span class="p">:</span><span class="n">FROM_SOURCE</span><span class="o">]-&gt;</span><span class="p">(:</span><span class="n">Source</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>NOT used for grounding calculation</strong> - only for citation and provenance.</p>
<h4 id="grounding-layer-evaluative-adr-044-adr-058">Grounding Layer (Evaluative - ADR-044, ADR-058)</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>Concept  Concept (relationships)
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>[:SUPPORTS], [:CONTRADICTS], [:ENABLES], etc.
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>                
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>        Polarity projection  Grounding strength
</code></pre></div>
<p><strong>Purpose:</strong> Truth convergence and validation
- <strong>Nature:</strong> Interpretive, evaluative assessment
- <strong>Method:</strong> Semantic projection of concept relationships onto polarity axis
- <strong>What it measures:</strong> How concepts validate/contradict each other
- <strong>Source:</strong> Concept-to-concept relationships, NOT source citations
- <strong>Algorithm:</strong> Polarity Axis Triangulation (ADR-058)</p>
<p><strong>Graph Traversal:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">Concept</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-[</span><span class="n">r</span><span class="o">]-</span><span class="p">(</span><span class="n">other</span><span class="p">:</span><span class="n">Concept</span><span class="p">)</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c1">// Project r onto SUPPORTS  CONTRADICTS axis</span>
</code></pre></div></p>
<h4 id="why-this-separation-matters">Why This Separation Matters</h4>
<p><strong>Evidence  Validation:</strong>
- Just because source text <em>states</em> something doesn't make it <em>grounded</em>
- Concepts from sources are neutral observations of what was written
- Grounding emerges from how concepts relate to <em>each other</em>, not from source citations</p>
<p><strong>Example:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>Source A: &quot;The earth is flat&quot;
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>   Concept: &quot;Flat Earth Model&quot; (neutral observation)
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>Source B: &quot;Spherical earth confirmed by gravity&quot;
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>   Concept: &quot;Spherical Earth Model&quot; (neutral observation)
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>Relationship: (Spherical Earth)-[:CONTRADICTS]-&gt;(Flat Earth)
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>   Grounding: Flat Earth has negative grounding (contradicted)
</code></pre></div></p>
<p>The source text itself doesn't determine truth - the <strong>semantic relationships between concepts</strong> do.</p>
<p><strong>This ADR addresses evidence retrieval only.</strong> Grounding calculation is handled separately by ADR-044 (Probabilistic Truth Convergence) and ADR-058 (Polarity Axis Triangulation).</p>
<h2 id="decision">Decision</h2>
<p>We will implement <strong>asynchronous source text embedding generation</strong> with the following design:</p>
<h3 id="1-separate-embeddings-table-with-referential-integrity">1. Separate Embeddings Table with Referential Integrity</h3>
<p><strong>Key Insight</strong>: Source nodes remain the canonical source of truth. Embeddings are stored separately with offset tracking and hash verification.</p>
<p><strong>Understanding the Chunking Architecture:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Document (100KB)
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>     Ingestion chunking (smart chunker with overlap)
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>     Source node 1 (500-1500 words)  Embedding chunk(s)
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>     Source node 2 (500-1500 words)  Embedding chunk(s)
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>     Source node 3 (500-1500 words)  Embedding chunk(s)
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>    ...
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>     Source node N (500-1500 words)  Embedding chunk(s)
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>                
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    Concepts extracted (references Sources)
</code></pre></div></p>
<p><strong>Two-level chunking:</strong>
1. <strong>Ingestion chunking</strong> (existing): Document  Source nodes (500-1500 words each)
2. <strong>Embedding chunking</strong> (this ADR): Source.full_text  Embedding chunks (~100-120 words each)</p>
<p><strong>Typical scenario:</strong>
- Large document  10 Source nodes (ingestion chunks)
- 100 concepts extracted  reference those 10 Sources
- Each Source  1-3 embedding chunks (depending on length)
- Total: 10-30 embeddings for entire document</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">-- Source node (canonical truth)</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="p">(:</span><span class="k">Source</span><span class="w"> </span><span class="err">{</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span><span class="n">source_id</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;doc123_chunk5&quot;</span><span class="p">,</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="n">full_text</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;...&quot;</span><span class="p">,</span><span class="w">           </span><span class="c1">-- Canonical text (500-1500 words from ingestion)</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="n">content_hash</span><span class="p">:</span><span class="w"> </span><span class="ss">&quot;sha256...&quot;</span><span class="w">   </span><span class="c1">-- Hash for verification (NULL for existing Sources)</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="err">}</span><span class="p">)</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="c1">-- Separate embeddings table with offsets</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">kg_api</span><span class="p">.</span><span class="n">source_embeddings</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span><span class="n">embedding_id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">    </span><span class="n">source_id</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">    </span><span class="c1">-- Chunk tracking</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span><span class="n">chunk_index</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">         </span><span class="c1">-- 0-based chunk number</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">    </span><span class="n">chunk_strategy</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">     </span><span class="c1">-- &#39;sentence&#39;, &#39;paragraph&#39;, &#39;semantic&#39;</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">    </span><span class="c1">-- Offset in Source.full_text (character positions)</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">    </span><span class="n">start_offset</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">    </span><span class="n">end_offset</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">    </span><span class="n">chunk_text</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">         </span><span class="c1">-- Actual chunk (for verification)</span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">    </span><span class="c1">-- Referential integrity (double hash verification)</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">    </span><span class="n">chunk_hash</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">         </span><span class="c1">-- SHA256 of chunk_text</span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">    </span><span class="n">source_hash</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">        </span><span class="c1">-- SHA256 of Source.full_text</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="w">    </span><span class="c1">-- Embedding data</span>
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="w">    </span><span class="n">embedding</span><span class="w"> </span><span class="n">BYTEA</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">    </span><span class="n">embedding_model</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">    </span><span class="n">embedding_dimension</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>
<a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="n">TIMESTAMPTZ</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">NOW</span><span class="p">(),</span>
<a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="w">    </span><span class="k">UNIQUE</span><span class="p">(</span><span class="n">source_id</span><span class="p">,</span><span class="w"> </span><span class="n">chunk_index</span><span class="p">,</span><span class="w"> </span><span class="n">chunk_strategy</span><span class="p">)</span>
<a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="p">);</span>
</code></pre></div>
<p><strong>Why separate table?</strong>
- One Source can have multiple embedding chunks (granular retrieval)
- Offsets enable precise text highlighting and context extraction
- Hash verification ensures embeddings match current source text
- Stale embeddings detectable when source text changes
- Supports multiple strategies per Source (sentence + paragraph)</p>
<h3 id="2-chunking-strategy">2. Chunking Strategy</h3>
<p>Source text will be chunked using <strong>simple, tunable strategies</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># In api/api/workers/source_embedding_worker.py</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c1"># Tuning constants (easy to adjust, no complex config needed)</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">CHUNKING_STRATEGIES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="s2">&quot;sentence&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>        <span class="s2">&quot;max_chars&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>      <span class="c1"># ~100-120 words</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>        <span class="s2">&quot;splitter&quot;</span><span class="p">:</span> <span class="s2">&quot;sentence&quot;</span>  <span class="c1"># Use sentence boundaries</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="p">},</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>    <span class="s2">&quot;paragraph&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>        <span class="s2">&quot;max_chars&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>      <span class="c1"># Use full Source.full_text</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>        <span class="s2">&quot;splitter&quot;</span><span class="p">:</span> <span class="kc">None</span>        <span class="c1"># No splitting needed</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>    <span class="p">},</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>    <span class="s2">&quot;semantic&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>        <span class="s2">&quot;max_chars&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>      <span class="c1"># ~200-250 words</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>        <span class="s2">&quot;splitter&quot;</span><span class="p">:</span> <span class="s2">&quot;semantic&quot;</span>  <span class="c1"># Use existing SemanticChunk logic</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>    <span class="p">}</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="p">}</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="c1"># Default strategy (simplest - no chunking)</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="n">DEFAULT_STRATEGY</span> <span class="o">=</span> <span class="s2">&quot;paragraph&quot;</span>
</code></pre></div>
<p><strong>Key Constraints</strong>:
- Source.full_text already bounded (500-1500 words from ingestion chunker)
- No chunk can exceed embedding model context window
- Simple constants in code - easy to tune, no database config needed</p>
<p><strong>Configuration</strong> (use existing embedding_config):
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># NO separate source_embedding_config table!</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c1"># Source embeddings use system-wide kg_api.embedding_config:</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">embedding_config</span> <span class="o">=</span> <span class="n">load_active_embedding_config</span><span class="p">()</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="p">{</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="s2">&quot;provider&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span> <span class="o">|</span> <span class="s2">&quot;openai&quot;</span><span class="p">,</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;nomic-ai/nomic-embed-text-v1.5&quot;</span><span class="p">,</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="s2">&quot;embedding_dimensions&quot;</span><span class="p">:</span> <span class="mi">768</span><span class="p">,</span>     <span class="c1"># MUST match concept embeddings!</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="s2">&quot;float16&quot;</span> <span class="o">|</span> <span class="s2">&quot;float32&quot;</span><span class="p">,</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    <span class="o">...</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="p">}</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="c1"># Why? Source embeddings must be comparable to concept embeddings.</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="c1"># Using different dimensions would break cosine similarity.</span>
</code></pre></div></p>
<p><strong>Always Enabled:</strong>
- Source embedding generation is a first-class system feature
- No opt-in/opt-out flags
- Runs automatically for all ingested Sources
- Can be regenerated via existing regenerate embeddings worker</p>
<h3 id="3-migration-strategy-add-field-compute-on-demand">3. Migration Strategy: Add Field, Compute On-Demand</h3>
<p><strong>Source.content_hash field:</strong>
- Migration 068 adds field to Source nodes
- <strong>NULL for existing Sources</strong> (no backfill in migration)
- Computed on-demand when embeddings generated
- Existing regenerate embeddings worker handles backfill</p>
<p><strong>Rationale:</strong>
- Avoid expensive migration (computing hash for all existing Sources)
- Leverage existing worker pattern (cures non-existent embeddings)
- Operators can regenerate at their leisure
- Non-blocking rollout</p>
<p><strong>Backfill process (optional, any time after migration):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Use existing regenerate embeddings pattern</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>kg<span class="w"> </span>admin<span class="w"> </span>regenerate-embeddings<span class="w"> </span>--type<span class="w"> </span><span class="nb">source</span><span class="w"> </span>--all
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># Or per ontology</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>kg<span class="w"> </span>admin<span class="w"> </span>regenerate-embeddings<span class="w"> </span>--type<span class="w"> </span><span class="nb">source</span><span class="w"> </span>--ontology<span class="w"> </span><span class="s2">&quot;MyDocs&quot;</span>
</code></pre></div></p>
<h3 id="4-hash-verification-for-referential-integrity">4. Hash Verification for Referential Integrity</h3>
<p><strong>Double verification prevents silent corruption</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># At embedding generation</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">source_text</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="s1">&#39;full_text&#39;</span><span class="p">]</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="n">source_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">(</span><span class="n">source_text</span><span class="p">)</span>      <span class="c1"># Hash of full source</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">:</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>    <span class="n">chunk_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>     <span class="c1"># Hash of this chunk</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>    <span class="n">db</span><span class="o">.</span><span class="n">insert_source_embedding</span><span class="p">(</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>        <span class="n">source_id</span><span class="o">=</span><span class="n">source_id</span><span class="p">,</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>        <span class="n">chunk_text</span><span class="o">=</span><span class="n">chunk</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>        <span class="n">chunk_hash</span><span class="o">=</span><span class="n">chunk_hash</span><span class="p">,</span>          <span class="c1">#  Verifies chunk integrity</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>        <span class="n">source_hash</span><span class="o">=</span><span class="n">source_hash</span><span class="p">,</span>        <span class="c1">#  Verifies source hasn&#39;t changed</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>        <span class="n">start_offset</span><span class="o">=</span><span class="n">chunk</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>        <span class="n">end_offset</span><span class="o">=</span><span class="n">chunk</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>        <span class="n">embedding</span><span class="o">=</span><span class="n">generate_embedding</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>    <span class="p">)</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="c1"># At query time</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="n">current_source_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">(</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;full_text&#39;</span><span class="p">])</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="k">for</span> <span class="n">embedding</span> <span class="ow">in</span> <span class="n">embeddings</span><span class="p">:</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>    <span class="k">if</span> <span class="n">embedding</span><span class="o">.</span><span class="n">source_hash</span> <span class="o">!=</span> <span class="n">current_source_hash</span><span class="p">:</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a>        <span class="c1"># Source text changed - embedding is stale</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>        <span class="n">flag_for_regeneration</span><span class="p">(</span><span class="n">embedding</span><span class="p">)</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>    <span class="c1"># Verify chunk extraction</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a>    <span class="n">extracted_chunk</span> <span class="o">=</span> <span class="n">source_text</span><span class="p">[</span><span class="n">embedding</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span><span class="n">embedding</span><span class="o">.</span><span class="n">end_offset</span><span class="p">]</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>    <span class="k">if</span> <span class="n">sha256</span><span class="p">(</span><span class="n">extracted_chunk</span><span class="p">)</span> <span class="o">!=</span> <span class="n">embedding</span><span class="o">.</span><span class="n">chunk_hash</span><span class="p">:</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>        <span class="c1"># Corruption detected!</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>        <span class="k">raise</span> <span class="n">IntegrityError</span><span class="p">(</span><span class="s2">&quot;Chunk hash mismatch&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Benefits</strong>:
- Detect when Source.full_text changes (invalidates embeddings)
- Verify chunk extraction matches original
- Enable automatic regeneration triggers
- Prevent serving stale embeddings</p>
<h3 id="5-async-job-processing">5. Async Job Processing</h3>
<p>Leverage existing job system (ADR-014) for embedding generation:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># New job type: &quot;source_embedding&quot;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="p">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="s2">&quot;job_type&quot;</span><span class="p">:</span> <span class="s2">&quot;source_embedding&quot;</span><span class="p">,</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;pending&quot;</span><span class="p">,</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="s2">&quot;job_data&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>        <span class="s2">&quot;ontology&quot;</span><span class="p">:</span> <span class="s2">&quot;MyOntology&quot;</span><span class="p">,</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>        <span class="s2">&quot;strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;paragraph&quot;</span><span class="p">,</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>        <span class="s2">&quot;source_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;src_123&quot;</span><span class="p">,</span> <span class="s2">&quot;src_456&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>  <span class="o">//</span> <span class="n">Batch</span> <span class="n">of</span> <span class="n">sources</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>        <span class="s2">&quot;embedding_provider&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>        <span class="s2">&quot;embedding_model&quot;</span><span class="p">:</span> <span class="s2">&quot;nomic-ai/nomic-embed-text-v1.5&quot;</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>    <span class="p">}</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Worker</strong>: <code>api/api/workers/source_embedding_worker.py</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_source_embedding_worker</span><span class="p">(</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>    <span class="n">job_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    <span class="n">job_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    <span class="n">job_queue</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="sd">    Generate embeddings for source text chunks.</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="sd">    Processing:</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="sd">    1. Fetch Source nodes by source_ids</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="sd">    2. Apply chunking strategy to full_text</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="sd">    3. Generate embeddings via EmbeddingWorker (ADR-045)</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="sd">    4. Update Source.embedding field</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="sd">    5. Report progress to job queue</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<h3 id="6-generation-triggers">6. Generation Triggers</h3>
<p><strong>At Ingestion Time</strong> (always enabled):
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># In api/api/workers/ingestion_worker.py</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="c1"># After creating Source node</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c1"># No enable/disable check - always generate embeddings</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">job_queue</span><span class="o">.</span><span class="n">submit_job</span><span class="p">({</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    <span class="s2">&quot;job_type&quot;</span><span class="p">:</span> <span class="s2">&quot;source_embedding&quot;</span><span class="p">,</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    <span class="s2">&quot;job_data&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>        <span class="s2">&quot;source_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">source_id</span><span class="p">],</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>        <span class="s2">&quot;ontology&quot;</span><span class="p">:</span> <span class="n">ontology</span><span class="p">,</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>        <span class="s2">&quot;strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;sentence&quot;</span>  <span class="c1"># Default strategy</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>    <span class="p">}</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="p">})</span>
</code></pre></div></p>
<p><strong>Bulk Regeneration</strong> (admin tool):
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Regenerate embeddings for entire ontology</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>kg<span class="w"> </span>admin<span class="w"> </span>regenerate-embeddings<span class="w"> </span>--ontology<span class="w"> </span><span class="s2">&quot;MyOntology&quot;</span><span class="w"> </span>--type<span class="w"> </span><span class="nb">source</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c1"># Regenerate for entire system (provider change)</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>kg<span class="w"> </span>admin<span class="w"> </span>regenerate-embeddings<span class="w"> </span>--type<span class="w"> </span><span class="nb">source</span><span class="w"> </span>--all
</code></pre></div></p>
<p><strong>Selective Regeneration</strong> (configuration change):
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Change embedding provider, regenerate affected sources</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>kg<span class="w"> </span>admin<span class="w"> </span>source-embeddings<span class="w"> </span>config<span class="w"> </span>--ontology<span class="w"> </span><span class="s2">&quot;MyOntology&quot;</span><span class="w"> </span>--strategy<span class="w"> </span>paragraph
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>kg<span class="w"> </span>admin<span class="w"> </span>source-embeddings<span class="w"> </span>generate<span class="w"> </span>--ontology<span class="w"> </span><span class="s2">&quot;MyOntology&quot;</span><span class="w"> </span>--force
</code></pre></div></p>
<h3 id="7-query-integration">7. Query Integration</h3>
<p><strong>New Search Mode: Source Similarity Search</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># API endpoint: POST /queries/sources/search</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="p">{</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="s2">&quot;query_text&quot;</span><span class="p">:</span> <span class="s2">&quot;How does recursive depth affect performance?&quot;</span><span class="p">,</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    <span class="s2">&quot;ontology&quot;</span><span class="p">:</span> <span class="s2">&quot;SystemDocs&quot;</span><span class="p">,</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="s2">&quot;include_concepts&quot;</span><span class="p">:</span> <span class="n">true</span>  <span class="o">//</span> <span class="n">Also</span> <span class="k">return</span> <span class="n">attached</span> <span class="n">concepts</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="p">}</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="c1"># Response</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="p">{</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>    <span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>        <span class="p">{</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>            <span class="s2">&quot;source_id&quot;</span><span class="p">:</span> <span class="s2">&quot;doc123_chunk5&quot;</span><span class="p">,</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>            <span class="s2">&quot;document&quot;</span><span class="p">:</span> <span class="s2">&quot;SystemDocs&quot;</span><span class="p">,</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>            <span class="s2">&quot;full_text&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>            <span class="s2">&quot;similarity&quot;</span><span class="p">:</span> <span class="mf">0.87</span><span class="p">,</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>            <span class="s2">&quot;concepts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>  <span class="o">//</span> <span class="n">Concepts</span> <span class="n">extracted</span> <span class="kn">from</span><span class="w"> </span><span class="nn">this</span> <span class="n">source</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>        <span class="p">}</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>    <span class="p">]</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Hybrid Search: Concept + Source</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Find concepts, then return supporting source passages</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="p">{</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>    <span class="s2">&quot;query_text&quot;</span><span class="p">:</span> <span class="s2">&quot;recursive relationships&quot;</span><span class="p">,</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>    <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;hybrid&quot;</span><span class="p">,</span>  <span class="o">//</span> <span class="n">Search</span> <span class="n">both</span> <span class="n">concepts</span> <span class="n">AND</span> <span class="n">sources</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>    <span class="s2">&quot;concept_limit&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>    <span class="s2">&quot;source_limit&quot;</span><span class="p">:</span> <span class="mi">10</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="p">}</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="c1"># Returns both concept matches AND similar source passages</span>
</code></pre></div>
<p><strong>Context Window: Source Neighbors</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1">// Given a matched concept, find neighboring source context</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">Concept</span><span class="w"> </span><span class="p">{</span><span class="n">concept_id</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="n">concept_id</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">APPEARS_IN</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">Source</span><span class="p">)</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">neighbor</span><span class="p">:</span><span class="n">Source</span><span class="w"> </span><span class="p">{</span><span class="n">document</span><span class="p">:</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">document</span><span class="p">})</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">neighbor</span><span class="p">.</span><span class="n">paragraph</span><span class="w"> </span><span class="p">&gt;=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">paragraph</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="m">2</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">  </span><span class="n">AND</span><span class="w"> </span><span class="n">neighbor</span><span class="p">.</span><span class="n">paragraph</span><span class="w"> </span><span class="p">&lt;=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">paragraph</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="m">2</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="k">RETURN</span><span class="w"> </span><span class="n">neighbor</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">neighbor</span><span class="p">.</span><span class="n">paragraph</span>
</code></pre></div>
<h3 id="8-cost-and-performance">8. Cost and Performance</h3>
<p><strong>Storage</strong>:
- 768-dim float16 embedding = 1.5KB per chunk
- Typical: 1-2 chunks per Source (500-1500 word Sources)
- Avg 1.5 chunks per Source = 2.25KB per Source
- 1M sources = ~2.25GB embedding storage
- Plus ~500 bytes metadata per chunk = ~750MB
- Total: ~3GB for 1M sources (acceptable for PostgreSQL)</p>
<p><strong>Note:</strong> Most Sources (500-1500 words) will have 1-2 embedding chunks at 500 char (~100 word) granularity.</p>
<p><strong>Generation</strong>:
- Local embeddings (Nomic): ~5-10ms per chunk (CPU fallback: ~20-50ms)
- Typical: 1-2 chunks per Source = ~10-20ms per Source
- OpenAI API: ~50-100ms per batch (rate limited)
- Async processing prevents ingestion blocking
- Hash calculation: &lt;1ms (negligible)
- Content_hash computed once per Source, cached in node</p>
<p><strong>Regeneration</strong>:
- Leverage existing regenerate embeddings worker
- Worker cures non-existent embeddings (NULL content_hash)
- 1M sources @ 15ms = ~4 hours (local, 1-2 chunks per Source)
- Progress tracking via job system
- Resumable on failure
- Can regenerate entire system or per-ontology</p>
<h2 id="consequences">Consequences</h2>
<h3 id="positive">Positive</h3>
<ol>
<li><strong>Referential Integrity</strong></li>
<li>Double hash verification (source + chunk)</li>
<li>Detect stale embeddings automatically</li>
<li>Prevent serving outdated results</li>
<li>
<p>Enable automatic regeneration triggers</p>
</li>
<li>
<p><strong>Granular Retrieval</strong></p>
</li>
<li>1-2 embeddings per Source (typical)</li>
<li>Precise offset tracking for highlighting</li>
<li>Context-aware search results</li>
<li>
<p>Chunking overlap from ingestion ensures continuity</p>
</li>
<li>
<p><strong>Complete Retrieval Coverage</strong></p>
</li>
<li>Text search (full-text)</li>
<li>Concept search (embeddings)</li>
<li>Source search (embeddings)  NEW</li>
<li>
<p>Visual search (image embeddings)</p>
</li>
<li>
<p><strong>Enhanced RAG</strong></p>
</li>
<li>Retrieve source passages directly</li>
<li>Combine with concept context</li>
<li>
<p>Build richer prompts for LLM generation</p>
</li>
<li>
<p><strong>Context Discovery</strong></p>
</li>
<li>Find similar passages across documents</li>
<li>Identify conceptual overlap via source similarity</li>
<li>
<p>Build "source graphs" of related passages</p>
</li>
<li>
<p><strong>LCM Foundation</strong></p>
</li>
<li>All graph elements become searchable</li>
<li>Enables emergent relationship discovery</li>
<li>
<p>Supports constructive multi-modal queries</p>
</li>
<li>
<p><strong>Provider Flexibility</strong></p>
</li>
<li>Regenerate embeddings when provider changes</li>
<li>A/B test embedding models</li>
<li>
<p>Mix providers per ontology</p>
</li>
<li>
<p><strong>Simple Configuration</strong></p>
</li>
<li>Uses existing kg_api.embedding_config (system-wide)</li>
<li>No separate configuration table</li>
<li>Must match concept embedding dimensions</li>
<li>
<p>Always enabled (first-class feature)</p>
</li>
<li>
<p><strong>Leverage Existing Patterns</strong></p>
</li>
<li>Uses existing regenerate embeddings worker</li>
<li>Worker cures NULL content_hash on-demand</li>
<li>No expensive migration backfill</li>
<li>Operators control regeneration timing</li>
</ol>
<h3 id="negative">Negative</h3>
<ol>
<li><strong>Storage Overhead</strong></li>
<li>+2.25KB per Source (1.5 chunks @ 1.5KB each, typical)</li>
<li>Plus ~750MB metadata (1M sources)</li>
<li>For 1M sources: ~3GB storage</li>
<li>
<p>Acceptable for PostgreSQL at scale</p>
</li>
<li>
<p><strong>Ingestion Latency</strong></p>
</li>
<li>Async job adds ~15ms per source (1-2 chunks typical)</li>
<li>Hash calculation adds &lt;1ms (cached in Source.content_hash)</li>
<li>Mitigated by background processing</li>
<li>
<p>Total impact negligible</p>
</li>
<li>
<p><strong>Schema Complexity</strong></p>
</li>
<li>Additional table to maintain (source_embeddings)</li>
<li>Hash verification logic required</li>
<li>
<p>Stale embedding detection needed</p>
</li>
<li>
<p><strong>API Complexity</strong></p>
</li>
<li>New search modes to maintain</li>
<li>Hybrid search requires careful tuning</li>
<li>
<p>Offset extraction and highlighting logic</p>
</li>
<li>
<p><strong>Migration Cost</strong></p>
</li>
<li>Migration 068 adds field only (fast, no backfill)</li>
<li>Existing Sources have NULL content_hash initially</li>
<li>Backfill via regenerate embeddings worker (optional, at leisure)</li>
<li>No downtime required (graceful degradation)</li>
</ol>
<h3 id="neutral">Neutral</h3>
<ol>
<li><strong>Always-On Feature</strong></li>
<li>Source embedding generation runs for all ingestions</li>
<li>No opt-in/opt-out (first-class system feature)</li>
<li>
<p>Simplified architecture (no conditional logic)</p>
</li>
<li>
<p><strong>Backward Compatible</strong></p>
</li>
<li>Migration adds field, NULL for existing Sources</li>
<li>Existing Source nodes continue working</li>
<li>Regenerate embeddings worker handles backfill</li>
<li>Queries gracefully handle NULL content_hash</li>
</ol>
<h2 id="implementation-plan">Implementation Plan</h2>
<h3 id="phase-1-foundation-week-1">Phase 1: Foundation (Week 1)</h3>
<ul>
<li>[ ] Migration 068: Create <code>kg_api.source_embeddings</code> table</li>
<li>[ ] Migration 068: Add <code>Source.content_hash</code> field (NULL for existing)</li>
<li>[ ] Implement hash verification utilities (SHA256)</li>
<li>[ ] Implement sentence chunking with offset tracking (500 chars)</li>
<li>[ ] Implement <code>SourceEmbeddingWorker</code> skeleton</li>
<li>[ ] Query active <code>embedding_config</code> for dimensions</li>
<li>[ ] Add job type "source_embedding" to queue</li>
</ul>
<h3 id="phase-2-generation-week-2">Phase 2: Generation (Week 2)</h3>
<ul>
<li>[ ] Implement full <code>SourceEmbeddingWorker</code> with chunking</li>
<li>[ ] Add hash verification at generation time</li>
<li>[ ] Store embeddings in <code>source_embeddings</code> table</li>
<li>[ ] Update <code>Source.content_hash</code> field when embedding</li>
<li>[ ] Add ingestion-time embedding generation (always enabled)</li>
<li>[ ] Test with small ontology (verify chunks, offsets, hashes)</li>
</ul>
<h3 id="phase-3-query-integration-week-3">Phase 3: Query Integration (Week 3)</h3>
<ul>
<li>[ ] Implement <code>/queries/sources/search</code> endpoint</li>
<li>[ ] Add stale embedding detection in queries</li>
<li>[ ] Return matched chunks with offsets for highlighting</li>
<li>[ ] Add context window expansion (neighboring chunks)</li>
<li>[ ] Implement hash verification at query time</li>
</ul>
<h3 id="phase-4-unified-embedding-regeneration-week-4">Phase 4: Unified Embedding Regeneration (Week 4)</h3>
<p><strong>Critical Infrastructure:</strong> Enables cross-entity semantic queries and global model migrations.</p>
<p><strong>Rationale:</strong> The system currently has embeddings in three namespaces:
1. <strong>Concepts</strong>: <code>Concept.embedding</code> (AGE graph nodes)
2. <strong>Sources</strong>: <code>kg_api.source_embeddings</code> table (this ADR)
3. <strong>Vocabulary</strong>: <code>kg_api.vocabulary_embeddings</code> table (ADR-044)</p>
<p>Without unified regeneration:
-  Cannot switch embedding models globally (must manually regenerate 3 systems)
-  Cannot guarantee cross-entity semantic compatibility
-  Cannot execute blended queries (concept + source + relationship)
-  Cannot discover emergent relationships via embedding proximity</p>
<p><strong>Phase 4 Solution: Single interface for ALL graph text embeddings</strong></p>
<h4 id="41-source-embedding-regeneration">4.1: Source Embedding Regeneration</h4>
<ul>
<li>[ ] Implement <code>regenerate_source_embeddings()</code> function in <code>source_embedding_worker.py</code></li>
<li>[ ] Fetch sources from AGE (filter by ontology, detect missing embeddings)</li>
<li>[ ] Batch process sources with progress tracking</li>
<li>[ ] Support <code>--only-missing</code> flag (skip sources with valid embeddings)</li>
<li>[ ] Detect and regenerate stale embeddings (hash mismatch)</li>
</ul>
<h4 id="42-vocabulary-embedding-regeneration">4.2: Vocabulary Embedding Regeneration</h4>
<ul>
<li>[ ] Implement <code>regenerate_vocabulary_embeddings()</code> function</li>
<li>[ ] Regenerate embeddings for all relationship types in vocabulary</li>
<li>[ ] Update <code>kg_api.vocabulary_embeddings</code> table</li>
<li>[ ] Support categorical filtering (semantic, structural, epistemic, etc.)</li>
</ul>
<h4 id="43-unified-api-endpoint">4.3: Unified API Endpoint</h4>
<ul>
<li>[ ] Add <code>/admin/regenerate-embeddings</code> endpoint (replaces <code>/admin/regenerate-concept-embeddings</code>)</li>
<li>[ ] Support <code>type</code> parameter: <code>concept</code>, <code>source</code>, <code>vocabulary</code>, <code>all</code></li>
<li>[ ] Support filters: <code>ontology</code>, <code>only_missing</code>, <code>limit</code>, <code>offset</code></li>
<li>[ ] Return unified progress tracking and statistics</li>
</ul>
<h4 id="44-cli-enhancement">4.4: CLI Enhancement</h4>
<ul>
<li>[ ] Update <code>kg admin regenerate-embeddings</code> command</li>
<li>[ ] Add <code>--type &lt;concept|source|vocabulary|all&gt;</code> flag (default: <code>concept</code>)</li>
<li>[ ] Support <code>--ontology &lt;name&gt;</code> (limit to specific namespace)</li>
<li>[ ] Support <code>--only-missing</code> (skip entities with valid embeddings)</li>
<li>[ ] Support <code>--limit &lt;n&gt;</code> and <code>--offset &lt;n&gt;</code> for batching</li>
<li>[ ] Unified progress display for all entity types</li>
</ul>
<h4 id="45-cross-entity-query-foundation">4.5: Cross-Entity Query Foundation</h4>
<ul>
<li>[ ] Document semantic query patterns (see "Cross-Entity Query Capabilities" below)</li>
<li>[ ] Add examples for blended search (concept + source + relationship)</li>
<li>[ ] Performance benchmarks for cross-entity queries</li>
<li>[ ] Add MCP tools for unified semantic search</li>
</ul>
<p><strong>Example Usage:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># Model migration: Regenerate ALL embeddings with new model</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>kg<span class="w"> </span>admin<span class="w"> </span>regenerate-embeddings<span class="w"> </span>--all
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c1"># Selective regeneration</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>kg<span class="w"> </span>admin<span class="w"> </span>regenerate-embeddings<span class="w"> </span>--type<span class="w"> </span>concept<span class="w"> </span>--ontology<span class="w"> </span><span class="s2">&quot;MyDocs&quot;</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>kg<span class="w"> </span>admin<span class="w"> </span>regenerate-embeddings<span class="w"> </span>--type<span class="w"> </span><span class="nb">source</span><span class="w"> </span>--only-missing
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>kg<span class="w"> </span>admin<span class="w"> </span>regenerate-embeddings<span class="w"> </span>--type<span class="w"> </span>vocabulary
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="c1"># Batch processing</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>kg<span class="w"> </span>admin<span class="w"> </span>regenerate-embeddings<span class="w"> </span>--type<span class="w"> </span><span class="nb">source</span><span class="w"> </span>--limit<span class="w"> </span><span class="m">1000</span><span class="w"> </span>--offset<span class="w"> </span><span class="m">0</span>
</code></pre></div>
<h3 id="phase-5-user-interface-integration-complete">Phase 5: User Interface Integration ( COMPLETE)</h3>
<p><strong>Implementation Date:</strong> 2025-11-29
<strong>Branch:</strong> <code>feature/adr-068-phase5-interfaces</code></p>
<p><strong>Goal:</strong> Provide source text search access across all user interaction methods.</p>
<h4 id="51-cli-source-search">5.1: CLI Source Search </h4>
<ul>
<li>[x] <code>kg search sources</code> command with full parameter support</li>
<li>[x] Query, limit, similarity, ontology filtering</li>
<li>[x] Formatted output with source passages, concepts, and similarity scores</li>
<li>[x] Integrated with existing search command structure</li>
</ul>
<h4 id="52-mcp-server-integration">5.2: MCP Server Integration </h4>
<ul>
<li>[x] Extended <code>search</code> tool with <code>type</code> parameter ('concepts' | 'sources')</li>
<li>[x] Source search results formatter (<code>formatSourceSearchResults</code>)</li>
<li>[x] Automatic routing based on search type</li>
<li>[x] Rich text output for AI consumption (passages, concepts, offsets)</li>
</ul>
<h4 id="53-web-ui-block-builder">5.3: Web UI Block Builder </h4>
<ul>
<li>[x] SourceSearchBlock component (Smart Block category)</li>
<li>[x] Query input, ontology filter, similarity slider, limit controls</li>
<li>[x] Execution logic extracting concepts from source passages</li>
<li>[x] Block compiler integration with comment annotations</li>
<li>[x] Help content and palette integration</li>
<li>[x] Amber color scheme (consistent with Smart Blocks)</li>
</ul>
<p><strong>Files Modified:</strong>
- <code>cli/src/mcp/formatters.ts</code> - Added <code>formatSourceSearchResults</code>
- <code>cli/src/mcp-server.ts</code> - Extended search tool with type parameter
- <code>web/src/api/client.ts</code> - Added <code>searchSources</code> method
- <code>web/src/components/blocks/SourceSearchBlock.tsx</code> - New component (142 lines)
- <code>web/src/components/blocks/BlockBuilder.tsx</code> - Execution logic
- <code>web/src/components/blocks/BlockPalette.tsx</code> - Added to Smart Blocks
- <code>web/src/components/blocks/blockHelpContent.ts</code> - Help documentation
- <code>web/src/types/blocks.ts</code> - Type definitions
- <code>web/src/lib/blockCompiler.ts</code> - Block compilation logic</p>
<p><strong>Testing:</strong>
-  CLI: <code>kg search sources "data"</code> returns 5 results
-  CLI: <code>kg search query "towers"</code> returns 2 concepts
-  Web UI: Block renders correctly with all controls
-  API: <code>/query/sources/search</code> endpoint working
-  MCP: Requires restart to test (in progress)</p>
<p><strong>Commits:</strong>
1. <code>feat(mcp): add source search tool with type parameter (ADR-068 Phase 5)</code> - 0744e837
2. <code>feat(web): add SourceSearchBlock for source text search (ADR-068 Phase 5)</code> - 7dfe0b8b
3. <code>fix(web): add source search execution logic to BlockBuilder</code> - 345304a0
4. <code>fix(web): add sourceSearch case to block compiler</code> - 5b479746
5. <code>fix(web): correct source search endpoint path</code> - 34ee7ce4</p>
<h3 id="phase-6-advanced-features-future">Phase 6: Advanced Features (Future)</h3>
<ul>
<li>[ ] Hybrid search (concept + source combined)</li>
<li>[ ] Semantic chunking strategy</li>
<li>[ ] Multiple strategies per Source</li>
<li>[ ] Cross-document source similarity</li>
<li>[ ] Edge embeddings for emergent relationships</li>
</ul>
<h2 id="cross-entity-query-capabilities">Cross-Entity Query Capabilities</h2>
<p><strong>The Emergent Power of Unified Semantic Space</strong></p>
<p>Once concepts, sources, and vocabulary (relationship types) share the same semantic space with compatible embeddings, powerful cross-entity query patterns emerge. This is the foundation of the <strong>Large Concept Model (LCM)</strong> architecture.</p>
<h3 id="1-dynamic-query-routing">1. Dynamic Query Routing</h3>
<p>Route queries to the most relevant entity type automatically:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># Single query  multiple semantic entry points</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;recursive depth management&quot;</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>    <span class="s2">&quot;via_concepts&quot;</span><span class="p">:</span> <span class="n">search_concepts</span><span class="p">(</span><span class="n">query</span><span class="p">),</span>           <span class="c1"># Direct concept match</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>    <span class="s2">&quot;via_sources&quot;</span><span class="p">:</span> <span class="n">search_sources</span><span class="p">(</span><span class="n">query</span><span class="p">),</span>             <span class="c1"># Evidence passage match</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>    <span class="s2">&quot;via_relationships&quot;</span><span class="p">:</span> <span class="n">search_relationships</span><span class="p">(</span><span class="n">query</span><span class="p">),</span> <span class="c1"># Semantic edge match</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="p">}</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="c1"># System automatically selects best entry point by similarity</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="n">best_entry</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">max_similarity</span><span class="p">)</span>
</code></pre></div>
<p><strong>Use Case:</strong> User doesn't know whether their query matches a concept name, a source passage, or a relationship type. The system finds the best match across all three and uses that as the entry point.</p>
<h3 id="2-semantic-path-discovery">2. Semantic Path Discovery</h3>
<p>Discover relationships not by exact type, but by semantic meaning:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1">// Traditional: Exact relationship traversal</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">Concept</span><span class="w"> </span><span class="p">{</span><span class="n">concept_id</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="n">id</span><span class="p">})</span><span class="o">-[</span><span class="p">:</span><span class="n">SUPPORTS</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c1">// With embeddings: Semantic relationship discovery</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">:</span><span class="n">Concept</span><span class="w"> </span><span class="p">{</span><span class="n">concept_id</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="n">id</span><span class="p">})</span><span class="o">-[</span><span class="n">r</span><span class="o">]-&gt;</span><span class="p">(</span><span class="n">target</span><span class="p">:</span><span class="n">Concept</span><span class="p">)</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">vocabulary_embedding_similarity</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">r</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;strengthens, enables, reinforces&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">.</span><span class="m">8</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="k">RETURN</span><span class="w"> </span><span class="n">target</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">vocabulary_embedding_similarity</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">r</span><span class="p">),</span><span class="w"> </span><span class="err">$</span><span class="n">query_embedding</span><span class="p">)</span><span class="w"> </span><span class="k">DESC</span>
</code></pre></div>
<p><strong>Use Case:</strong> Find all concepts that "support" a given concept, but include relationships with semantically similar meanings (ENABLES, REINFORCES, STRENGTHENS, etc.).</p>
<h3 id="3-multi-entity-blending">3. Multi-Entity Blending</h3>
<p>Merge results from multiple entity types for comprehensive coverage:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># Query: &quot;How does probabilistic reasoning work?&quot;</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c1"># Strategy A: Find concepts directly</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="n">concepts_direct</span> <span class="o">=</span> <span class="n">search_concepts</span><span class="p">(</span><span class="s2">&quot;probabilistic reasoning&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="c1"># Strategy B: Find source passages  extract their concepts</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="n">sources</span> <span class="o">=</span> <span class="n">search_sources</span><span class="p">(</span><span class="s2">&quot;probabilistic reasoning&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="n">concepts_from_sources</span> <span class="o">=</span> <span class="n">get_concepts_for_sources</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="c1"># Strategy C: Find relationships  traverse to concepts</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="n">relationships</span> <span class="o">=</span> <span class="n">search_relationships</span><span class="p">(</span><span class="s2">&quot;probabilistic reasoning&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="n">concepts_via_edges</span> <span class="o">=</span> <span class="n">get_concepts_connected_by</span><span class="p">(</span><span class="n">relationships</span><span class="p">)</span>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="c1"># BLEND: Merge + deduplicate + rank by combined signals</span>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="n">blended_results</span> <span class="o">=</span> <span class="n">merge_and_rank</span><span class="p">([</span>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>    <span class="p">(</span><span class="n">concepts_direct</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>          <span class="c1"># Direct matches</span>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>    <span class="p">(</span><span class="n">concepts_from_sources</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span>    <span class="c1"># Evidence-based</span>
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>    <span class="p">(</span><span class="n">concepts_via_edges</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>        <span class="c1"># Relationship-based</span>
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="p">])</span>
</code></pre></div>
<p><strong>Use Case:</strong> Comprehensive search that considers all perspectivesconcepts mentioned explicitly, concepts discussed in sources, and concepts connected via semantically relevant relationships.</p>
<h3 id="4-contextual-re-ranking">4. Contextual Re-Ranking</h3>
<p>Rank evidence by semantic relevance to the query, not just presence:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1"># Query: &quot;grounding strength calculation&quot;</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="c1"># Step 1: Find best concept match</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="n">concept</span> <span class="o">=</span> <span class="n">search_concepts</span><span class="p">(</span><span class="s2">&quot;grounding strength&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="c1"># Step 2: Get evidence, but rank by CONTEXT similarity</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="n">evidence</span> <span class="o">=</span> <span class="n">get_concept_evidence</span><span class="p">(</span><span class="n">concept</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">evidence</span><span class="p">:</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>    <span class="c1"># Traditional: &quot;This source mentions this concept&quot; (binary)</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>    <span class="c1"># Enhanced: &quot;This source passage is contextually relevant to the query&quot; (scored)</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>    <span class="n">source</span><span class="o">.</span><span class="n">relevance_score</span> <span class="o">=</span> <span class="n">cosine_similarity</span><span class="p">(</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>        <span class="n">embed</span><span class="p">(</span><span class="s2">&quot;grounding strength calculation&quot;</span><span class="p">),</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>        <span class="n">source</span><span class="o">.</span><span class="n">embedding</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>    <span class="p">)</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="c1"># Return context-aware evidence ranking</span>
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">evidence</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">relevance_score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p><strong>Use Case:</strong> Show the most relevant evidence firstpassages that not only mention the concept but discuss it in the context the user cares about.</p>
<h3 id="5-semantic-subgraph-extraction">5. Semantic Subgraph Extraction</h3>
<p>Extract connected subgraphs based on semantic similarity, not just explicit edges:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1"># &quot;Show me everything semantically related to &#39;epistemic status&#39;&quot;</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="n">query_emb</span> <span class="o">=</span> <span class="n">embed</span><span class="p">(</span><span class="s2">&quot;epistemic status&quot;</span><span class="p">)</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="c1"># Find ALL entities semantically close (threshold = 0.7)</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="n">semantic_neighborhood</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>    <span class="s2">&quot;concepts&quot;</span><span class="p">:</span> <span class="n">cosine_search</span><span class="p">(</span><span class="n">Concept</span><span class="o">.</span><span class="n">embedding</span><span class="p">,</span> <span class="n">query_emb</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>    <span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="n">cosine_search</span><span class="p">(</span><span class="n">source_embeddings</span><span class="p">,</span> <span class="n">query_emb</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>    <span class="s2">&quot;relationships&quot;</span><span class="p">:</span> <span class="n">cosine_search</span><span class="p">(</span><span class="n">vocabulary_embeddings</span><span class="p">,</span> <span class="n">query_emb</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="p">}</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="c1"># Extract connected subgraph containing these entities</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="n">subgraph</span> <span class="o">=</span> <span class="n">extract_connected_subgraph</span><span class="p">(</span><span class="n">semantic_neighborhood</span><span class="p">)</span>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="c1"># Visualize: Everything semantically related, regardless of entity type</span>
</code></pre></div>
<p><strong>Use Case:</strong> Explore a topic by finding all concepts, sources, and relationships semantically related to itnot just those explicitly linked.</p>
<h3 id="6-emergent-relationship-discovery">6. Emergent Relationship Discovery</h3>
<p>Find implicit relationships via embedding proximity:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1">// Find concepts that are semantically similar but not explicitly connected</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">c1</span><span class="p">:</span><span class="n">Concept</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">c2</span><span class="p">:</span><span class="n">Concept</span><span class="p">)</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">embedding_similarity</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">)</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">.</span><span class="m">85</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">  </span><span class="n">AND</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="p">(</span><span class="n">c1</span><span class="p">)</span><span class="o">-[]-</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span><span class="w">  </span><span class="c1">// Not explicitly connected</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="c1">// Find sources that bridge them</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="k">MATCH</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="n">Source</span><span class="p">)</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">source_embedding_similarity</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="p">)</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">.</span><span class="m">75</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="w">  </span><span class="n">AND</span><span class="w"> </span><span class="n">source_embedding_similarity</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">)</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">.</span><span class="m">75</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="k">RETURN</span><span class="w"> </span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">,</span><span class="w"> </span><span class="n">s</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="c1">// Result: &quot;These concepts aren&#39;t linked, but this source passage</span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="c1">//          discusses both  potential emergent relationship&quot;</span>
</code></pre></div>
<p><strong>Use Case:</strong> Discover hidden connectionsconcepts that should be related based on semantic proximity but haven't been explicitly linked yet.</p>
<h3 id="7-cross-modal-query-fusion-future">7. Cross-Modal Query Fusion (Future)</h3>
<p>With visual embeddings (ADR-057), blend text + visual semantics:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1"># Query: &quot;system architecture&quot;</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="n">results</span> <span class="o">=</span> <span class="n">blend_multimodal</span><span class="p">([</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>    <span class="n">search_concepts</span><span class="p">(</span><span class="s2">&quot;system architecture&quot;</span><span class="p">),</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>    <span class="n">search_sources</span><span class="p">(</span><span class="s2">&quot;architecture diagrams&quot;</span><span class="p">),</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>    <span class="n">search_relationships</span><span class="p">(</span><span class="s2">&quot;defines structure&quot;</span><span class="p">),</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>    <span class="n">search_images</span><span class="p">(</span><span class="n">visual_query</span><span class="o">=</span><span class="s2">&quot;architecture diagram&quot;</span><span class="p">)</span>  <span class="c1"># Visual similarity</span>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="p">])</span>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="c1"># Result: Concepts + passages + diagrams, all ranked by semantic relevance</span>
</code></pre></div>
<p><strong>Use Case:</strong> Find everything related to a topicconcepts, source passages, AND diagrams/imagesall ranked by unified semantic similarity.</p>
<h2 id="why-this-matters-the-lcm-vision">Why This Matters: The LCM Vision</h2>
<p>Traditional RAG (Retrieval-Augmented Generation):
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>Documents  Chunks  Embeddings  Vector DB  Retrieve  Generate
</code></pre></div></p>
<p>Large Concept Model (LCM) with Unified Embeddings:
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>Documents  {Concepts, Sources, Relationships}  Embeddings  Multi-Entity Graph
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>                                                       
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>                        Dynamic Routing + Blending + Emergent Discovery
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>                                                       
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>                              Semantic Subgraphs + Context-Aware Ranking
</code></pre></div></p>
<p><strong>Key Differences:</strong>
1. <strong>Multi-Entity</strong>: Not just document chunks, but concepts + sources + relationships
2. <strong>Semantic Graph</strong>: Explicit edges PLUS embedding-based proximity
3. <strong>Dynamic Routing</strong>: Query finds best entry point automatically
4. <strong>Blended Results</strong>: Combine signals from multiple entity types
5. <strong>Emergent Discovery</strong>: Find implicit relationships via embedding similarity</p>
<p><strong>This is only possible with unified embedding regeneration (Phase 4).</strong></p>
<h2 id="alternatives-considered">Alternatives Considered</h2>
<h3 id="alternative-1-generate-embeddings-at-query-time">Alternative 1: Generate Embeddings at Query Time</h3>
<p><strong>Rejected</strong>: Too slow for real-time queries. Source embedding generation would block response.</p>
<h3 id="alternative-2-store-single-embedding-on-source-node">Alternative 2: Store Single Embedding on Source Node</h3>
<p><strong>Rejected</strong>: Cannot support multiple chunks per Source. Loses granularity and offset tracking.</p>
<h3 id="alternative-3-only-embed-concept-descriptions-status-quo">Alternative 3: Only Embed Concept Descriptions (Status Quo)</h3>
<p><strong>Rejected</strong>: Loses access to full source context. Cannot retrieve similar passages directly.</p>
<h3 id="alternative-4-use-full-text-search-only">Alternative 4: Use Full-Text Search Only</h3>
<p><strong>Rejected</strong>: Full-text search is lexical, not semantic. Misses conceptual similarity.</p>
<h2 id="key-design-decisions-summary">Key Design Decisions Summary</h2>
<h3 id="1-content_hash-field-add-dont-backfill">1. content_hash Field: Add, Don't Backfill</h3>
<ul>
<li>Migration adds field to Source nodes</li>
<li>NULL for existing Sources</li>
<li>Computed on-demand during embedding generation</li>
<li>Leverage existing regenerate embeddings worker for backfill</li>
</ul>
<h3 id="2-no-separate-configuration">2. No Separate Configuration</h3>
<ul>
<li>Use existing <code>kg_api.embedding_config</code> (system-wide)</li>
<li>Source embeddings MUST match concept embedding dimensions</li>
<li>No opt-in/opt-out flags</li>
</ul>
<h3 id="3-chunk-size-500-characters-100-words">3. Chunk Size: 500 Characters (~100 words)</h3>
<ul>
<li>Balances granularity vs overhead</li>
<li>Most Sources (500-1500 words)  1-2 embedding chunks</li>
<li>Large document: 10 Sources  10-20 embeddings total</li>
<li>Chunking overlap from ingestion ensures continuity</li>
</ul>
<h3 id="4-always-enabled">4. Always Enabled</h3>
<ul>
<li>Source embedding generation is first-class feature</li>
<li>Runs automatically for all ingestions</li>
<li>Simplified architecture (no conditional logic)</li>
</ul>
<h3 id="5-leverage-existing-patterns">5. Leverage Existing Patterns</h3>
<ul>
<li>Existing regenerate embeddings worker handles backfill</li>
<li>Worker cures NULL content_hash</li>
<li>Operators control regeneration timing</li>
</ul>
<h2 id="related-adrs">Related ADRs</h2>
<ul>
<li><strong>ADR-022</strong>: Semantic Relationship Taxonomy (Porter stemmer hybrid chunking with overlap)</li>
<li><strong>ADR-044</strong>: Probabilistic Truth Convergence (relationship embeddings for grounding)</li>
<li><strong>ADR-045</strong>: Unified Embedding Generation (EmbeddingWorker architecture)</li>
<li><strong>ADR-057</strong>: Multimodal Image Ingestion (visual embeddings for images)</li>
<li><strong>ADR-014</strong>: Job Approval Workflow (async job processing)</li>
<li><strong>ADR-039</strong>: Local Embedding Service (embedding configuration system)</li>
</ul>
<h2 id="references">References</h2>
<h3 id="large-concept-model-lcm-vision">Large Concept Model (LCM) Vision</h3>
<p>The term "Large Concept Model" extends the RAG paradigm to full graph embeddings:</p>
<p><strong>Traditional RAG Stack:</strong>
1. Chunk documents
2. Embed chunks
3. Store in vector DB
4. Retrieve similar chunks
5. Generate response</p>
<p><strong>LCM Stack (Proposed):</strong>
1. Chunk documents  Sources
2. Extract concepts  Concepts
3. Generate relationships  Edges
4. Embed EVERYTHING  Sources, Concepts, Edges
5. Multi-modal retrieval  Text, concept, relationship, visual
6. Graph-aware generation  Context from graph structure + embeddings
7. Emergent synthesis  Discover new relationships via proximity</p>
<p>This ADR implements step 4 for Sources, completing the embedding coverage.</p>
<h3 id="external-resources">External Resources</h3>
<ul>
<li><a href="https://arxiv.org/abs/2004.04906">Dense Passage Retrieval (DPR)</a> - Dual-encoder architecture for passage retrieval</li>
<li><a href="https://arxiv.org/abs/2004.12832">ColBERT</a> - Late interaction for efficient passage ranking</li>
<li><a href="https://arxiv.org/abs/2002.08909">REALM</a> - Retrieval-augmented language model pre-training</li>
<li><a href="https://arxiv.org/abs/1901.00596">Graph Neural Networks</a> - Comprehensive survey of GNN architectures</li>
</ul>
<h2 id="appendix-example-queries">Appendix: Example Queries</h2>
<h3 id="source-similarity-search">Source Similarity Search</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1"># Find passages similar to query</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">client</span><span class="o">.</span><span class="n">search_sources</span><span class="p">(</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>    <span class="n">query</span><span class="o">=</span><span class="s2">&quot;How does grounding strength work?&quot;</span><span class="p">,</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>    <span class="n">ontology</span><span class="o">=</span><span class="s2">&quot;ADRs&quot;</span><span class="p">,</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>    <span class="n">limit</span><span class="o">=</span><span class="mi">5</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="p">)</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="c1"># Returns:</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="c1"># - Top 5 most similar source passages</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="c1"># - Attached concepts for each passage</span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="c1"># - Similarity scores</span>
</code></pre></div>
<h3 id="hybrid-concept-source-search">Hybrid Concept + Source Search</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># Find concepts, then expand to source context</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="n">results</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">hybrid_search</span><span class="p">(</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>    <span class="n">query</span><span class="o">=</span><span class="s2">&quot;epistemic status measurement&quot;</span><span class="p">,</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>    <span class="n">concept_limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>    <span class="n">source_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>    <span class="n">expand_context</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># Include neighboring source paragraphs</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="p">)</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="c1"># Returns:</span>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="c1"># - 3 most relevant concepts</span>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="c1"># - 10 most similar source passages</span>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a><span class="c1"># - Context window around matched sources</span>
</code></pre></div>
<h3 id="context-window-for-concept">Context Window for Concept</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1"># Given a concept, find surrounding source context</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="n">client</span><span class="o">.</span><span class="n">get_concept_context</span><span class="p">(</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>    <span class="n">concept_id</span><span class="o">=</span><span class="s2">&quot;concept-123&quot;</span><span class="p">,</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>    <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span>  <span class="c1"># 2 paragraphs</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="p">)</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="c1"># Returns:</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="c1"># - Source paragraph containing concept</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="c1"># - 2 paragraphs before</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="c1"># - 2 paragraphs after</span>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="c1"># - Enables reading concept in original context</span>
</code></pre></div>
<h3 id="cross-document-source-similarity">Cross-Document Source Similarity</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1"># Find similar passages across multiple documents</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="n">client</span><span class="o">.</span><span class="n">cross_document_similarity</span><span class="p">(</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>    <span class="n">source_id</span><span class="o">=</span><span class="s2">&quot;doc1_chunk5&quot;</span><span class="p">,</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>    <span class="n">ontologies</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ADRs&quot;</span><span class="p">,</span> <span class="s2">&quot;CodeDocs&quot;</span><span class="p">,</span> <span class="s2">&quot;Research&quot;</span><span class="p">],</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>    <span class="n">limit</span><span class="o">=</span><span class="mi">10</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="p">)</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="c1"># Returns:</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="c1"># - Similar passages from other documents</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="c1"># - Identifies conceptual overlap</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="c1"># - Builds &quot;source graph&quot; of related passages</span>
</code></pre></div>
<hr />
<p><strong>Last Updated:</strong> 2025-11-27
<strong>Next Review:</strong> After Phase 1 implementation (1 month)</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>